train_df_4<-df_4[c(1:42385),][-c(1:191),]
library(glmnet)
View(train_df_4)
train_df4_0<-filter(train_df_4, Saat=="00:00")
test_df4_0<-filter(test_df_4, Saat=="00:00")
cvfit_0=cv.glmnet(train_df4_0[,-c(1:4)],train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0
predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)]))
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)]))
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0
set.seed(1)
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100)
cvfit_0
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_0
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_0
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)]))
ae_t4_0<-abs(prediction_df4_0/test_df4_0$consumption)
ae_t4_0<-mean(abs(prediction_df4_0/test_df4_0$consumption))
ae_t4_0<-abs(prediction_df4_0/test_df4_0$consumption)
train_df4_1<-filter(train_df_4, Saat=="01:00")
test_df4_1<-filter(test_df_4, Saat=="01:00")
cvfit_1=cv.glmnet(as.matrix(train_df4_1[,-c(1:4)]),train_df4_1$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_1
prediction_df4_1<-predict(cvfit_1,newx = as.matrix(test_df4_1[,-c(1:4)]))
ae_t4_1<-abs(prediction_df4_1/test_df4_1$consumption)
train_df4_2<-filter(train_df_4, Saat=="02:00")
test_df4_2<-filter(test_df_4, Saat=="02:00")
cvfit_2=cv.glmnet(as.matrix(train_df4_2[,-c(1:4)]),train_df4_2$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_2
prediction_df4_2<-predict(cvfit_2,newx = as.matrix(test_df4_2[,-c(1:4)]))
ae_t4_2<-abs(prediction_df4_2/test_df4_2$consumption)
train_df4_3<-filter(train_df_4, Saat=="03:00")
test_df4_3<-filter(test_df_4, Saat=="03:00")
cvfit_3=cv.glmnet(as.matrix(train_df4_3[,-c(1:4)]),train_df4_3$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_3
prediction_df4_3<-predict(cvfit_3,newx = as.matrix(test_df4_3[,-c(1:4)]))
ae_t4_3<-abs(prediction_df4_3/test_df4_3$consumption)
train_df4_4<-filter(train_df_4, Saat=="04:00")
test_df4_4<-filter(test_df_4, Saat=="04:00")
cvfit_4=cv.glmnet(as.matrix(train_df4_4[,-c(1:4)]),train_df4_4$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_4
prediction_df4_4<-predict(cvfit_4,newx = as.matrix(test_df4_4[,-c(1:4)]))
ae_t4_4<-abs(prediction_df4_4/test_df4_4$consumption)
train_df4_5<-filter(train_df_5, Saat=="05:00")
train_df4_5<-filter(train_df_5, Saat=="05:00")
train_df4_5<-filter(train_df_4, Saat=="05:00")
test_df4_5<-filter(test_df_4, Saat=="05:00")
train_df4_5<-filter(train_df_4, Saat=="05:00")
test_df4_5<-filter(test_df_4, Saat=="05:00")
cvfit_5=cv.glmnet(as.matrix(train_df4_5[,-c(1:4)]),train_df4_5$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_5
prediction_df4_5<-predict(cvfit_5,newx = as.matrix(test_df4_5[,-c(1:4)]))
ae_t4_5<-abs(prediction_df4_5/test_df4_5$consumption)
train_df4_6<-filter(train_df_4, Saat=="06:00")
test_df4_6<-filter(test_df_4, Saat=="06:00")
cvfit_6=cv.glmnet(as.matrix(train_df4_6[,-c(1:4)]),train_df4_6$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_6
prediction_df4_6<-predict(cvfit_6,newx = as.matrix(test_df4_6[,-c(1:4)]))
ae_t4_6<-abs(prediction_df4_6/test_df4_6$consumption)
ae_t4_7<-abs(prediction_df4_7/test_df4_7$consumption)
train_df4_7<-filter(train_df_4, Saat=="07:00")
test_df4_7<-filter(test_df_4, Saat=="07:00")
cvfit_7=cv.glmnet(as.matrix(train_df4_7[,-c(1:4)]),train_df4_7$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_7
prediction_df4_7<-predict(cvfit_7,newx = as.matrix(test_df4_7[,-c(1:4)]))
ae_t4_7<-abs(prediction_df4_7/test_df4_7$consumption)
train_df4_8<-filter(train_df_4, Saat=="08:00")
test_df4_8<-filter(test_df_4, Saat=="08:00")
cvfit_8=cv.glmnet(as.matrix(train_df4_8[,-c(1:4)]),train_df4_8$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_8
prediction_df4_8<-predict(cvfit_8,newx = as.matrix(test_df4_8[,-c(1:4)]))
ae_t4_8<-abs(prediction_df4_8/test_df4_8$consumption)
train_df4_9<-filter(train_df_4, Saat=="09:00")
test_df4_9<-filter(test_df_4, Saat=="09:00")
cvfit_9=cv.glmnet(as.matrix(train_df4_9[,-c(1:4)]),train_df4_9$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_9
prediction_df4_9<-predict(cvfit_9,newx = as.matrix(test_df4_9[,-c(1:4)]))
ae_t4_9<-abs(prediction_df4_9/test_df4_9$consumption)
train_df4_10<-filter(train_df_4, Saat=="10:00")
test_df4_10<-filter(test_df_4, Saat=="10:00")
cvfit_10=cv.glmnet(as.matrix(train_df4_10[,-c(1:4)]),train_df4_10$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_10
prediction_df4_10<-predict(cvfit_10,newx = as.matrix(test_df4_10[,-c(1:4)]))
ae_t4_10<-abs(prediction_df4_10/test_df4_10$consumption)
train_df4_11<-filter(train_df_4, Saat=="11:00")
test_df4_11<-filter(test_df_4, Saat=="11:00")
cvfit_11=cv.glmnet(as.matrix(train_df4_11[,-c(1:4)]),train_df4_11$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_11
prediction_df4_11<-predict(cvfit_11,newx = as.matrix(test_df4_11[,-c(1:4)]))
ae_t4_11<-abs(prediction_df4_11/test_df4_11$consumption)
train_df4_12<-filter(train_df_4, Saat=="12:00")
test_df4_12-filter(test_df_4, Saat=="12:00")
test_df4_12-filter(test_df_4, Saat=="12:00")
train_df4_12<-filter(train_df_4, Saat=="12:00")
test_df4_12-filter(test_df_4, Saat=="12:00")
test_df4_12<-filter(test_df_4, Saat=="12:00")
cvfit_12=cv.glmnet(as.matrix(train_df4_12[,-c(1:4)]),train_df4_12$consumption,family='gaussian',nfolds=100,set.seed(1))
train_df4_12<-filter(train_df_4, Saat=="12:00")
test_df4_12<-filter(test_df_4, Saat=="12:00")
cvfit_12=cv.glmnet(as.matrix(train_df4_12[,-c(1:4)]),train_df4_12$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_12
prediction_df4_12<-predict(cvfit_12,newx = as.matrix(test_df4_12[,-c(1:4)]))
ae_t4_12<-abs(prediction_df4_12/test_df4_12$consumption)
train_df4_13<-filter(train_df_4, Saat=="13:00")
test_df4_13<-filter(test_df_4, Saat=="13:00")
cvfit_13=cv.glmnet(as.matrix(train_df4_13[,-c(1:4)]),train_df4_13$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_13
prediction_df4_13<-predict(cvfit_13,newx = as.matrix(test_df4_13[,-c(1:4)]))
ae_t4_13<-abs(prediction_df4_13/test_df4_13$consumption)
train_df4_14<-filter(train_df_4, Saat=="14:00")
test_df4_14<-filter(test_df_4, Saat=="14:00")
cvfit_14=cv.glmnet(as.matrix(train_df4_14[,-c(1:4)]),train_df4_14$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_14
prediction_df4_14<-predict(cvfit_14,newx = as.matrix(test_df4_14[,-c(1:4)]))
ae_t4_14<-abs(prediction_df4_14/test_df4_14$consumption)
train_df4_15<-filter(train_df_4, Saat=="15:00")
test_df4_15<-filter(test_df_4, Saat=="15:00")
cvfit_15=cv.glmnet(as.matrix(train_df4_15[,-c(1:4)]),train_df4_15$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_15
prediction_df4_15<-predict(cvfit_15,newx = as.matrix(test_df4_15[,-c(1:4)]))
ae_t4_15<-abs(prediction_df4_15/test_df4_15$consumption)
train_df4_16<-filter(train_df_4, Saat=="16:00")
test_df4_16<-filter(test_df_4, Saat=="16:00")
cvfit_16=cv.glmnet(as.matrix(train_df4_16[,-c(1:4)]),train_df4_16$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_16
prediction_df4_16<-predict(cvfit_16,newx = as.matrix(test_df4_16[,-c(1:4)]))
ae_t4_16<-abs(prediction_df4_16/test_df4_16$consumption)
train_df4_17<-filter(train_df_4, Saat=="17:00")
test_df4_17<-filter(test_df_4, Saat=="17:00")
cvfit_17=cv.glmnet(as.matrix(train_df4_17[,-c(1:4)]),train_df4_17$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_17
prediction_df4_17<-predict(cvfit_17,newx = as.matrix(test_df4_17[,-c(1:4)]))
ae_t4_17<-abs(prediction_df4_17/test_df4_17$consumption)
train_df4_18<-filter(train_df_4, Saat=="18:00")
test_df4_18<-filter(test_df_4, Saat=="18:00")
cvfit_18=cv.glmnet(as.matrix(train_df4_18[,-c(1:4)]),train_df4_18$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_18
prediction_df4_18<-predict(cvfit_18,newx = as.matrix(test_df4_18[,-c(1:4)]))
ae_t4_18<-abs(prediction_df4_18/test_df4_18$consumption)
train_df4_19<-filter(train_df_4, Saat=="19:00")
test_df4_19<-filter(test_df_4, Saat=="19:00")
cvfit_19=cv.glmnet(as.matrix(train_df4_19[,-c(1:4)]),train_df4_19$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_19
prediction_df4_19<-predict(cvfit_19,newx = as.matrix(test_df4_19[,-c(1:4)]))
ae_t4_19<-abs(prediction_df4_19/test_df4_19$consumption)
train_df4_20<-filter(train_df_4, Saat=="20:00")
test_df4_20<-filter(test_df_4, Saat=="20:00")
cvfit_20=cv.glmnet(as.matrix(train_df4_20[,-c(1:4)]),train_df4_20$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_20
prediction_df4_20<-predict(cvfit_20,newx = as.matrix(test_df4_20[,-c(1:4)]))
ae_t4_20<-abs(prediction_df4_20/test_df4_20$consumption)
train_df4_21<-filter(train_df_4, Saat=="21:00")
test_df4_21<-filter(test_df_4, Saat=="21:00")
cvfit_21=cv.glmnet(as.matrix(train_df4_21[,-c(1:4)]),train_df4_21$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_21
prediction_df4_21<-predict(cvfit_21,newx = as.matrix(test_df4_21[,-c(1:4)]))
ae_t4_21<-abs(prediction_df4_21/test_df4_21$consumption)
train_df4_22<-filter(train_df_4, Saat=="22:00")
test_df4_22<-filter(test_df_4, Saat=="22:00")
cvfit_22=cv.glmnet(as.matrix(train_df4_22[,-c(1:4)]),train_df4_22$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_22
prediction_df4_22<-predict(cvfit_22,newx = as.matrix(test_df4_22[,-c(1:4)]))
ae_t4_22<-abs(prediction_df4_22/test_df4_22$consumption)
train_df4_23<-filter(train_df_4, Saat=="23:00")
test_df4_23<-filter(test_df_4, Saat=="23:00")
cvfit_23=cv.glmnet(as.matrix(train_df4_23[,-c(1:4)]),train_df4_23$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_23
prediction_df4_23<-predict(cvfit_23,newx = as.matrix(test_df4_23[,-c(1:4)]))
ae_t4_23<-abs(prediction_df4_23/test_df4_23$consumption)
mape_t4<-mean(ae_t4_0,ae_t4_1,ae_t4_2,ae_t4_3,ae_t4_4,ae_t4_5,ae_t4_6,ae_t4_7,ae_t4_8,ae_t4_9,ae_t4_10,ae_t4_11,ae_t4_12,ae_t4_13,ae_t4_14,ae_t4_15,ae_t4_16,ae_t4_17,ae_t4_18,ae_t4_19,ae_t4_20,ae_t4_21,ae_t4_22,ae_t4_23)
ape_t4<-rbind(ae_t4_0,ae_t4_1,ae_t4_2,ae_t4_3,ae_t4_4,ae_t4_5,ae_t4_6,ae_t4_7,ae_t4_8,ae_t4_9,ae_t4_10,ae_t4_11,ae_t4_12,ae_t4_13,ae_t4_14,ae_t4_15,ae_t4_16,ae_t4_17,ae_t4_18,ae_t4_19,ae_t4_20,ae_t4_21,ae_t4_22,ae_t4_23)
mape<-mean(ape_t4)
mape_t4<-mean(ape_t4)
knitr::opts_chunk$set(echo = TRUE)
mape_scores_4<-cbind(mape_scores_3,mape_hourly_lasso=mape_t4)
mape_scores_4
knitr::opts_chunk$set(echo = TRUE)
df<-read.csv("C:/Users/asus/Desktop/elektrik.csv")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(glmnet)
df<-read.csv("C:/Users/asus/Desktop/elektrik.csv")
df<-df %>% rename(consumption = Tüketim.Miktarı..MWh.)
head(df[with(df, order("Tarih", "Saat"))])
index<-c(1:nrow(df))
df<-cbind(index=index,df)
#plot(df$index[c(1:100)],df$consumption[c(1:100)])
df<-read.csv("C:/Users/asus/Desktop/elektrik.csv")
df<-read.csv("C:/Users/asus/Desktop/elektrik.csv")
df<-df %>% rename(consumption = Tüketim.Miktarı..MWh.)
head(df[with(df, order("Tarih", "Saat"))])
index<-c(1:nrow(df))
df<-cbind(index=index,df)
#plot(df$index[c(1:100)],df$consumption[c(1:100)])
View(df)
df<-as.data.frame(read.csv("C:/Users/asus/Desktop/elektrik.csv"))
df<-df %>% rename(consumption = Tüketim.Miktarı..MWh.)
head(df[with(df, order("Tarih", "Saat"))])
index<-c(1:nrow(df))
df<-cbind(index=index,df)
#plot(df$index[c(1:100)],df$consumption[c(1:100)])
df<-as.data.frame(read.csv("C:/Users/asus/Desktop/elektrik.csv"))
View(df)
df<-cbind(df[,1:2],consumption=df[,3])
View(df)
df<-as.data.frame(read.csv("C:/Users/asus/Desktop/elektrik.csv"))
df<-cbind(df[,1:2],consumption=df[,3])
head(df[with(df, order("Tarih", "Saat"))])
index<-c(1:nrow(df))
df<-cbind(index=index,df)
#plot(df$index[c(1:100)],df$consumption[c(1:100)])
summary(df$consumption)
str(df$consumption)
str(df)
df$consumption<-as.numeric(df$consumption)
df$lagged_48<-lag(df$consumption,48)
df$lagged_168<-lag(df$consumption,168)
test_df<-df[-c(1:42385),]
train_df<-df[c(1:42385),][-c(1:168),]
df$consumption<-as.numeric(df$consumption)
df$lagged_48<-lag(df$consumption,48)
df$lagged_168<-lag(df$consumption,168)
test_df<-df[-c(1:42385),]
train_df<-df[c(1:42385),][-c(1:168),]
boxplot(df$consumption)
boxplot(df$consumption)
plot(test_df$consumption,test_df$lagged_48)
plot(test_df$consumption,test_df$lagged_48)
abline(a=0,b=1,col=2)
plot(test_df$consumption,test_df$lagged_48,xlab ="Consumption" ylab="Consumption of 2 days before")
plot(test_df$consumption,test_df$lagged_48,xlab ="Consumption",ylab="Consumption of 2 days before")
plot(test_df$consumption,test_df$lagged_48,xlab ="Consumption",ylab="Consumption-lag 48")
plot(test_df$consumption,test_df$lagged_48,xlab ="Consumption",ylab="Consumption - lag 48")
plot(test_df$consumption,test_df$lagged_48,xlab ="Consumption",ylab="Consumption - lag 48")
abline(a=0,b=1,col=2)
plot(test_df$consumption,test_df$lagged_168,xlab ="Consumption",ylab="Consumption - lag 168")
abline(a=0,b=1,col=2)
mape_scores
mape_48<-mean(abs(test_df$lagged_48/test_df$consumption))
mape_168<-mean(abs(test_df$lagged_168/test_df$consumption))
mape_scores<-cbind(naive_lag_168=mape_168,naive_lag_48=mape_48)
mape_scores
summary(fit)
fit<-lm(consumption~lagged_48+lagged_168,data=train_df)
summary(fit)
summary(fit)
prediction<-predict(fit,test_df[,5:6])
plot(test_df$consumption,prediction)
plot(test_df$consumption,prediction, xlab="Real Consumption", ylab="Prediction")
prediction<-predict(fit,test_df[,5:6])
plot(test_df$consumption,prediction, xlab="Real Consumption", ylab="Prediction")
abline(a=0,b=1,col=2)
mape_reg<-mean(abs(prediction/test_df$consumption))
mape_scores_2<-cbind(mape_scores,mape_reg)
mape_scores_2
mape_reg<-mean(abs(prediction/test_df$consumption))
mape_scores_2<-cbind(mape_scores,mape_reg)
mape_scores_2
mape_reg<-mean(abs(prediction/test_df$consumption))
mape_scores_2<-cbind(mape_scores,mape_reg)
mape_scores_2
train_0<-filter(train_df, Saat=="00:00")
test_0<-filter(test_df, Saat=="00:00")
fit_0<-lm(consumption~lagged_48+lagged_168,data=train_0)
summary(fit_0)
#2 Days
df_4<-df[,1:4]
df_4$day_2_h_0<-lag(df$consumption,48)
df_4$day_2_h_1<-lag(df$consumption,49)
df_4$day_2_h_2<-lag(df$consumption,50)
df_4$day_2_h_3<-lag(df$consumption,51)
df_4$day_2_h_4<-lag(df$consumption,52)
df_4$day_2_h_5<-lag(df$consumption,53)
df_4$day_2_h_6<-lag(df$consumption,54)
df_4$day_2_h_7<-lag(df$consumption,55)
df_4$day_2_h_8<-lag(df$consumption,56)
df_4$day_2_h_9<-lag(df$consumption,57)
df_4$day_2_h_10<-lag(df$consumption,58)
df_4$day_2_h_11<-lag(df$consumption,59)
df_4$day_2_h_12<-lag(df$consumption,60)
df_4$day_2_h_13<-lag(df$consumption,61)
df_4$day_2_h_14<-lag(df$consumption,62)
df_4$day_2_h_15<-lag(df$consumption,63)
df_4$day_2_h_16<-lag(df$consumption,64)
df_4$day_2_h_17<-lag(df$consumption,65)
df_4$day_2_h_18<-lag(df$consumption,66)
df_4$day_2_h_19<-lag(df$consumption,67)
df_4$day_2_h_20<-lag(df$consumption,68)
df_4$day_2_h_21<-lag(df$consumption,69)
df_4$day_2_h_22<-lag(df$consumption,70)
df_4$day_2_h_23<-lag(df$consumption,71)
#7 Days
df_4$day_7_h_0<-lag(df$consumption,168)
df_4$day_7_h_1<-lag(df$consumption,169)
df_4$day_7_h_2<-lag(df$consumption,170)
df_4$day_7_h_3<-lag(df$consumption,170)
df_4$day_7_h_4<-lag(df$consumption,172)
df_4$day_7_h_5<-lag(df$consumption,173)
df_4$day_7_h_6<-lag(df$consumption,174)
df_4$day_7_h_7<-lag(df$consumption,175)
df_4$day_7_h_8<-lag(df$consumption,176)
df_4$day_7_h_9<-lag(df$consumption,177)
df_4$day_7_h_10<-lag(df$consumption,178)
df_4$day_7_h_11<-lag(df$consumption,179)
df_4$day_7_h_12<-lag(df$consumption,180)
df_4$day_7_h_13<-lag(df$consumption,181)
df_4$day_7_h_14<-lag(df$consumption,182)
df_4$day_7_h_15<-lag(df$consumption,183)
df_4$day_7_h_16<-lag(df$consumption,184)
df_4$day_7_h_17<-lag(df$consumption,185)
df_4$day_7_h_18<-lag(df$consumption,186)
df_4$day_7_h_19<-lag(df$consumption,187)
df_4$day_7_h_20<-lag(df$consumption,188)
df_4$day_7_h_21<-lag(df$consumption,189)
df_4$day_7_h_22<-lag(df$consumption,190)
df_4$day_7_h_23<-lag(df$consumption,191)
test_df_4<-df_4[-c(1:42385),]
train_df_4<-df_4[c(1:42385),][-c(1:191),]
train_df4_0<-filter(train_df_4, Saat=="00:00")
test_df4_0<-filter(test_df_4, Saat=="00:00")
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=100,set.seed(1))
cvfit_0
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_0
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)]),s = 1se)
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)]), s =1se)
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)]))
plot(cvfit_0)
coef(cvfit,s="lambda.1se")
coef(cvfit_0,s="lambda.1se")
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4),s="lambda.1se"]))
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=10,set.seed(1),s="lambda.1se")
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_0
plot(cvfit_0)
coef(cvfit_0,s="lambda.1se")
coef(cvfit_0,s=cv$lambda.1se)
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)],s=cv$lambda.1se))
ae_t4_0<-abs(prediction_df4_0/test_df4_0$consumption)
ae_t4_0
mean(ae_t4_0)
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)],s=cv$lambda.1se))
ae_t4_0<-abs(prediction_df4_0/test_df4_0$consumption)
plot(cvfit_0)
cvfit_0
cvfit_0
coef(cvfit_0,s="lambda.1se")
plot(cvfit_0)
coef(cvfit_0,s="lambda.1se")
train_df4_1<-filter(train_df_4, Saat=="01:00")
test_df4_1<-filter(test_df_4, Saat=="01:00")
cvfit_1=cv.glmnet(as.matrix(train_df4_1[,-c(1:4)]),train_df4_1$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_1
plot(cvfit_1)
train_df4_1<-filter(train_df_4, Saat=="01:00")
test_df4_1<-filter(test_df_4, Saat=="01:00")
cvfit_1=cv.glmnet(as.matrix(train_df4_1[,-c(1:4)]),train_df4_1$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_1
plot(cvfit_1)
coef(cvfit_1,s="lambda.1se")
cvfit_1
coef(cvfit_1,s="lambda.1se")
train_df4_2<-filter(train_df_4, Saat=="02:00")
test_df4_2<-filter(test_df_4, Saat=="02:00")
cvfit_2=cv.glmnet(as.matrix(train_df4_2[,-c(1:4)]),train_df4_2$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_2
plot(cvfit_2)
coef(cvfit_2,s="lambda.1se")
prediction_df4_2<-predict(cvfit_2,newx = as.matrix(test_df4_2[,-c(1:4)],s=cv$lambda.1se))
ae_t4_2<-abs(prediction_df4_2/test_df4_2$consumption)
train_df4_3<-filter(train_df_4, Saat=="03:00")
test_df4_3<-filter(test_df_4, Saat=="03:00")
cvfit_3=cv.glmnet(as.matrix(train_df4_3[,-c(1:4)]),train_df4_3$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_3
plot(cvfit_2)
coef(cvfit_2,s="lambda.1se")
prediction_df4_3<-predict(cvfit_3,newx = as.matrix(test_df4_3[,-c(1:4)],s=cv$lambda.1se))
ae_t4_3<-abs(prediction_df4_3/test_df4_3$consumption)
prediction_df4_4<-predict(cvfit_4,newx = as.matrix(test_df4_4[,-c(1:4)],s=cvfit_4$lambda.1se))
train_df4_4<-filter(train_df_4, Saat=="04:00")
cvfit_4
plot(cvfit_4)
train_df4_4<-filter(train_df_4, Saat=="04:00")
test_df4_4<-filter(test_df_4, Saat=="04:00")
cvfit_4=cv.glmnet(as.matrix(train_df4_4[,-c(1:4)]),train_df4_4$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_4
plot(cvfit_4)
coef(cvfit_4,s="lambda.1se")
prediction_df4_4<-predict(cvfit_4,newx = as.matrix(test_df4_4[,-c(1:4)],s=cvfit_4$lambda.1se))
ae_t4_4<-abs(prediction_df4_4/test_df4_4$consumption)
mean(ae_t4_0)
train_df4_3<-filter(train_df_4, Saat=="03:00")
test_df4_3<-filter(test_df_4, Saat=="03:00")
cvfit_3=cv.glmnet(as.matrix(train_df4_3[,-c(1:4)]),train_df4_3$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_3
plot(cvfit_3)
coef(cvfit_3,s="lambda.1se")
prediction_df4_3<-predict(cvfit_3,newx = as.matrix(test_df4_3[,-c(1:4)],s=cvfit_3$lambda.1se))
ae_t4_3<-abs(prediction_df4_3/test_df4_3$consumption)
train_df4_2<-filter(train_df_4, Saat=="02:00")
test_df4_2<-filter(test_df_4, Saat=="02:00")
cvfit_2=cv.glmnet(as.matrix(train_df4_2[,-c(1:4)]),train_df4_2$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_2
plot(cvfit_2)
coef(cvfit_2,s="lambda.1se")
prediction_df4_2<-predict(cvfit_2,newx = as.matrix(test_df4_2[,-c(1:4)],s=cvfit_2$lambda.1se))
ae_t4_2<-abs(prediction_df4_2/test_df4_2$consumption)
prediction_df4_1<-predict(cvfit_1,newx = as.matrix(test_df4_1[,-c(1:4)],s=cvfit_1$lambda.1se)))
train_df4_1<-filter(train_df_4, Saat=="01:00")
test_df4_1<-filter(test_df_4, Saat=="01:00")
cvfit_1=cv.glmnet(as.matrix(train_df4_1[,-c(1:4)]),train_df4_1$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_1
plot(cvfit_1)
coef(cvfit_1,s="lambda.1se")
prediction_df4_1<-predict(cvfit_1,newx = as.matrix(test_df4_1[,-c(1:4)],s=cvfit_1$lambda.1se)))
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)],s=cvfit_0$lambda.1se))
ae_t4_0<-abs(prediction_df4_0/test_df4_0$consumption)
prediction_df4_1<-predict(cvfit_1,newx = as.matrix(test_df4_1[,-c(1:4)],s=cvfit_1$lambda.1se)))
prediction_df4_2<-predict(cvfit_2,newx = as.matrix(test_df4_2[,-c(1:4)],s=cvfit_2$lambda.1se)
prediction_df4_2<-predict(cvfit_2,newx = as.matrix(test_df4_2[,-c(1:4)],s=cvfit_2$lambda.1se)
prediction_df4_2<-predict(cvfit_2,newx = as.matrix(test_df4_2[,-c(1:4)],s=cvfit_2$lambda.1se))
ae_t4_2<-abs(prediction_df4_2/test_df4_2$consumption)
train_df4_5<-filter(train_df_4, Saat=="05:00")
test_df4_5<-filter(test_df_4, Saat=="05:00")
cvfit_5=cv.glmnet(as.matrix(train_df4_5[,-c(1:4)]),train_df4_5$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_5
plot(cvfit_5)
coef(cvfit_5,s="lambda.1se")
prediction_df4_5<-predict(cvfit_5,newx = as.matrix(test_df4_5[,-c(1:4)],s=cvfit_5$lambda.1se))
ae_t4_5<-abs(prediction_df4_5/test_df4_5$consumption)
train_df4_6<-filter(train_df_4, Saat=="06:00")
test_df4_6<-filter(test_df_4, Saat=="06:00")
cvfit_6=cv.glmnet(as.matrix(train_df4_6[,-c(1:4)]),train_df4_6$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_6
plot(cvfit_6)
coef(cvfit_6,s="lambda.1se")
prediction_df4_6<-predict(cvfit_6,newx = as.matrix(test_df4_6[,-c(1:4)],,s=cvfit_6$lambda.1s))
ae_t4_6<-abs(prediction_df4_6/test_df4_6$consumption)
prediction_df4_6<-predict(cvfit_6,newx = as.matrix(test_df4_6[,-c(1:4)],s=cvfit_6$lambda.1s))
train_df4_7<-filter(train_df_4, Saat=="07:00")
test_df4_7<-filter(test_df_4, Saat=="07:00")
cvfit_7=cv.glmnet(as.matrix(train_df4_7[,-c(1:4)]),train_df4_7$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_7
plot(cvfit_7)
coef(cvfit_7,s="lambda.1se")
prediction_df4_7<-predict(cvfit_7,newx = as.matrix(test_df4_7[,-c(1:4)],s=cvfit_7$lambda.1s))
ae_t4_7<-abs(prediction_df4_7/test_df4_7$consumption)
train_df4_8<-filter(train_df_4, Saat=="08:00")
test_df4_8<-filter(test_df_4, Saat=="08:00")
cvfit_8=cv.glmnet(as.matrix(train_df4_8[,-c(1:4)]),train_df4_8$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_8
plot(cvfit_8)
coef(cvfit_8,s="lambda.1se")
prediction_df4_8<-predict(cvfit_8,newx = as.matrix(test_df4_8[,-c(1:4)],s=cvfit_7$lambda.1s))
ae_t4_8<-abs(prediction_df4_8/test_df4_8$consumption)
train_df4_9<-filter(train_df_4, Saat=="09:00")
test_df4_9<-filter(test_df_4, Saat=="09:00")
cvfit_9=cv.glmnet(as.matrix(train_df4_9[,-c(1:4)]),train_df4_9$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_9
plot(cvfit_9)
coef(cvfit_9,s="lambda.1se")
prediction_df4_9<-predict(cvfit_9,newx = as.matrix(test_df4_9[,-c(1:4)],s=cvfit_7$lambda.1s))
ae_t4_9<-abs(prediction_df4_9/test_df4_9$consumption)
train_df4_10<-filter(train_df_4, Saat=="10:00")
test_df4_10<-filter(test_df_4, Saat=="10:00")
cvfit_10=cv.glmnet(as.matrix(train_df4_10[,-c(1:4)]),train_df4_10$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_10
plot(cvfit_10)
coef(cvfit_10,s="lambda.1se")
prediction_df4_10<-predict(cvfit_10,newx = as.matrix(test_df4_10[,-c(1:4)],s=cvfit_10$lambda.1s))
ae_t4_10<-abs(prediction_df4_10/test_df4_10$consumption)
train_df4_20<-filter(train_df_4, Saat=="20:00")
test_df4_20<-filter(test_df_4, Saat=="20:00")
cvfit_20=cv.glmnet(as.matrix(train_df4_20[,-c(1:4)]),train_df4_20$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_20
plot(cvfit_20)
coef(cvfit_20,s="lambda.1se")
prediction_df4_20<-predict(cvfit_20,newx = as.matrix(test_df4_20[,-c(1:4)],s=cvfit_20$lambda.1s))
ae_t4_20<-abs(prediction_df4_20/test_df4_20$consumption)
train_df4_0<-filter(train_df_4, Saat=="00:00")
test_df4_0<-filter(test_df_4, Saat=="00:00")
cvfit_0=cv.glmnet(as.matrix(train_df4_0[,-c(1:4)]),train_df4_0$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_0
plot(cvfit_0)
coef(cvfit_0,s="lambda.1se")
prediction_df4_0<-predict(cvfit_0,newx = as.matrix(test_df4_0[,-c(1:4)],s=cvfit_0$lambda.1se))
ae_t4_0<-abs(prediction_df4_0/test_df4_0$consumption)
train_df4_1<-filter(train_df_4, Saat=="01:00")
test_df4_1<-filter(test_df_4, Saat=="01:00")
cvfit_1=cv.glmnet(as.matrix(train_df4_1[,-c(1:4)]),train_df4_1$consumption,family='gaussian',nfolds=10,set.seed(1))
cvfit_1
plot(cvfit_1)
coef(cvfit_1,s="lambda.1se")
prediction_df4_1<-predict(cvfit_1,newx = as.matrix(test_df4_1[,-c(1:4)],s=cvfit_1$lambda.1se)))
prediction_df4_1<-predict(cvfit_1,newx = as.matrix(test_df4_1[,-c(1:4)],s=cvfit_1$lambda.1se))
