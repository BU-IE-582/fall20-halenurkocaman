bw_df<-b365 %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
bw_df<-bw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
View(bw_df)
bw_df$ort<-seq(-0.825,0.925,by=0.05)
bw_df$draw_real_prob<-bw_df$draw_num/bw_df$obs
ggplot() +
geom_point(data=bw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=bw, aes(x=ph_pa, y=P_draw))+
geom_point(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
iw$p_range<-cut(iw$ph_pa,breaks = seq(-1,1,by=0.05))
iw_df<-iw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
iw_df$ort<-seq(-0.825,0.925,by=0.05)
iw_df$draw_real_prob<-iw_df$draw_num/iw_df$obs
iw<-data[,c(1:8,31:33)]
iw$P_home<-1/iw$IWH
iw$P_draw<-1/iw$IWD
iw$P_away<-1/iw$IWA
iw$sum_prob<-iw$P_home+iw$P_draw+iw$P_away
iw$NP_home<-iw$P_home/iw$sum_prob
iw$NP_draw<-iw$P_draw/iw$sum_prob
iw$NP_away<-iw$P_away/iw$sum_prob
iw$ph_pa<-iw$P_home-iw$P_away
iw$nph_npa<-iw$NP_home-iw$NP_away
ggplot(iw, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Some Bookmaker")
iw$p_range<-cut(iw$ph_pa,breaks = seq(-1,1,by=0.05))
iw_df<-iw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
iw_df$ort<-seq(-0.825,0.925,by=0.05)
iw_df$draw_real_prob<-iw_df$draw_num/iw_df$obs
bw$is_draw<-ifelse(bw$FTR=="D",1,0)
bw$P_home<-1/bw$BWH
bw$P_draw<-1/bw$BWD
bw$P_away<-1/bw$BWA
bw$sum_prob<-bw$P_home+bw$P_draw+bw$P_away
bw$NP_home<-bw$P_home/bw$sum_prob
bw$NP_draw<-bw$P_draw/bw$sum_prob
bw$NP_away<-bw$P_away/bw$sum_prob
bw$ph_pa<-bw$P_home-bw$P_away
bw$nph_npa<-bw$NP_home-bw$NP_away
ggplot(bw, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Bet and Win")
bw$p_range<-cut(bw$ph_pa,breaks = seq(-1,1,by=0.05))
bw_df<-bw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
bw_df$ort<-seq(-0.825,0.925,by=0.05)
bw_df$draw_real_prob<-bw_df$draw_num/bw_df$obs
ggplot() +
geom_point(data=bw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=bw, aes(x=ph_pa, y=P_draw))+
geom_point(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
iw$is_draw<-ifelse(iw$FTR=="D",1,0)
iw$P_home<-1/iw$IWH
iw$P_draw<-1/iw$IWD
iw$P_away<-1/iw$IWA
iw$sum_prob<-iw$P_home+iw$P_draw+iw$P_away
iw$NP_home<-iw$P_home/iw$sum_prob
iw$NP_draw<-iw$P_draw/iw$sum_prob
iw$NP_away<-iw$P_away/iw$sum_prob
iw$ph_pa<-iw$P_home-iw$P_away
iw$nph_npa<-iw$NP_home-iw$NP_away
ggplot(iw, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Some Bookmaker")
iw$p_range<-cut(iw$ph_pa,breaks = seq(-1,1,by=0.05))
iw_df<-iw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
iw_df$ort<-seq(-0.825,0.925,by=0.05)
iw_df$draw_real_prob<-iw_df$draw_num/iw_df$obs
ggplot() +
geom_point(data=bw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=bw, aes(x=ph_pa, y=P_draw))+
geom_point(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
View(data)
#TASK 3
task3<-filter(data, HR==0 & AR ==0)
#####TASK 2#####
data.frame(colnames(data))
b365<-data[,c(1:8,23:27)]
b365$is_draw<-ifelse(b365$FTR=="D",1,0)
b365$P_home<-1/b365$B365H
b365$P_draw<-1/b365$B365D
b365$P_away<-1/b365$B365A
b365$sum_prob<-b365$P_home + b365$P_draw + b365$P_away
b365$NP_home<-b365$P_home/b365$sum_prob
b365$NP_draw<-b365$P_draw/b365$sum_prob
b365$NP_away<-b365$P_away/b365$sum_prob
b365$ph_pa<-b365$P_home-b365$P_away
b365$nph_npa<-b365$NP_home-b365$NP_away
ggplot(b365, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") +  ggtitle("Bet 365")+
geom_smooth()
bw<-data[,c(1:8,23:24,28:30)]
bw$is_draw<-ifelse(bw$FTR=="D",1,0)
iw<-data[,c(1:8,23:24,31:33)]
iw$is_draw<-ifelse(iw$FTR=="D",1,0)
#TASK 3
t3_b365<-filter(, HR==0 & AR ==0)
#TASK 3
t3_b365<-filter(b365, HR==0 & AR ==0)
source('~/GitHub/fall20-halenurkocaman/work/hw1 updated.R', echo=TRUE)
View(t3_b365)
View(b365)
t3_b365_df<-t3_b365 %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
t3_b365_df$ort<-seq(-0.825,0.925,by=0.05)
t3_b365_df$draw_real_prob<-t3_b365_df$draw_num/t3_b365_df$obs
ggplot() +
geom_point(data=t3_b365, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=t3_b365, aes(x=ph_pa, y=P_draw))+
geom_point(data=t3_b365_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=t3_b365_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
#BET AND WIN-remove red cards
t3_bw<-filter(bw, HR==0 & AR ==0)
t3_bw_df<-t3_bw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
t3_bw_df$ort<-seq(-0.825,0.925,by=0.05)
t3_bw_df$draw_real_prob<-t3_bw_df$draw_num/t3_bw_df$obs
ggplot() +
geom_point(data=t3_bw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=t3_bw, aes(x=ph_pa, y=P_draw))+
geom_point(data=t3_bw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=t3_bw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
#SOME BOOKMAKER
t3_iw<-filter(iw, HR==0 & AR ==0)
t3_iw_df<-t3_iw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
t3_iw_df$ort<-seq(-0.825,0.925,by=0.05)
t3_iw_df$draw_real_prob<-t3_iw_df$draw_num/t3_iw_df$obs
ggplot() +
geom_point(data=t3_iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=t3_iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=t3_iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=t3_iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
x
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
source('~/GitHub/fall20-halenurkocaman/work/hw1 updated.R', echo=TRUE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_path(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_line(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_line(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
View(data)
ps<-data[,c(1:8,23:24,31:33)]
ps$is_draw<-ifelse(ps$FTR=="D",1,0)
ps$P_home<-1/ps$IWH
ps$P_draw<-1/ps$IWD
ps$P_away<-1/ps$IWA
ps$sum_prob<-ps$P_home+ps$P_draw+ps$P_away
ps$NP_home<-ps$P_home/ps$sum_prob
ps$NP_draw<-ps$P_draw/ps$sum_prob
ps$NP_away<-ps$P_away/ps$sum_prob
ps$ph_pa<-ps$P_home-ps$P_away
ps$nph_npa<-ps$NP_home-ps$NP_away
ggplot(ps, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Pinnacle")
library(readxl)
library(ggplot2)
library(tidyverse)
epl <- read_excel("C:/Users/asus/Desktop/all_data.xlsx")
data<-as.data.frame(epl[,1:56])
str(data)
data[,-c(1,2,3,4,5,8,11,12)]<-apply(data[,-c(1,2,3,4,5,8,11,12)],2,as.numeric)
data[,8]<-as.factor(data[,8])
task1<-data[,6:7]
task1$HG_AG<-task1$FTHG-task1$FTAG
#Home Goals Histogram
ggplot(task1, aes(FTHG)) +
geom_histogram(binwidth= 1, color="black", fill="plum") +
xlab("Home Goals") + ylab("Number of Games") +
scale_x_discrete(limits=c(0:max(task1$FTHG)))
hg<-task1 %>%
group_by(FTHG) %>%
summarise(obs=n())
ggplot(hg, aes(FTHG,obs)) +
geom_col(binwidth= 1, color="black", fill="plum")+
geom_line(aes(y=exp_pois))+
scale_x_discrete(limits=c(0:max(task1$FTHG)))
hg$exp_pois<-dpois(c(0:max(task1$FTHG)),lambda= mean(task1$FTHG))*nrow(task1)
#Away Goals Histogram with Density
ggplot(task1, aes(FTAG)) +
geom_histogram(aes(y=..density..),binwidth= 1, color="black", fill="lavender") +
xlab("Away Goals") + ylab("Number of Games") +
scale_x_discrete(limits=c(0:max(task1$FTAG)))+
geom_line(aes(y=dpois(FTAG,lambda= mean(FTAG))), colour="purple")
#Away Goals Histogram with Expected Poisson
ag<-task1 %>%
group_by(FTAG) %>%
summarise(obs=n())
#Away Goals Histogram
ggplot(task1, aes(FTAG)) +
geom_histogram(binwidth= 1, color="black", fill="lavender") +
xlab("Away Goals") + ylab("Number of Games")+
scale_x_discrete(limits=c(0:max(task1$FTAG)))
ag[10,]<-ag[8,]
ag[8,]<-c(7,0)
ag[9,]<-c(8,0)
ag$exp_pois<-dpois(c(0:max(task1$FTAG)),lambda= mean(task1$FTAG))*nrow(task1)
#Calculation
m<-mean(task1$HG_AG)
ggplot(ag, aes(FTAG,obs)) +
geom_col(color="black", fill="lavender")+
geom_line(aes(y=exp_pois))+
scale_x_discrete(limits=c(0:max(task1$FTAG)))
#Home-Away Goals Histogram
ggplot(task1, aes(HG_AG)) +
geom_histogram(binwidth= 1, color="black", fill="bisque") +
xlab("Home-Away Goals") + ylab("Number of Games")
sdev<-sd(task1$HG_AG)
#Home-Away Goals Histogram with Density-red shows the normal distribution
ggplot(task1, aes(HG_AG)) +
geom_histogram(aes(y=..density..),binwidth= 1, color="black", fill="bisque") +
xlab("Home-Away Goals") + ylab("Number of Games") +geom_density() +
stat_function(color="red",fun = dnorm, args = list(mean = m, sd = sdev)) +
scale_y_continuous(breaks = NULL)
#####TASK 2#####
data.frame(colnames(data))
b365<-data[,c(1:8,23:27)]
b365$is_draw<-ifelse(b365$FTR=="D",1,0)
b365$P_home<-1/b365$B365H
b365$NP_away<-b365$P_away/b365$sum_prob
b365$ph_pa<-b365$P_home-b365$P_away
b365$nph_npa<-b365$NP_home-b365$NP_away
b365$NP_draw<-b365$P_draw/b365$sum_prob
ggplot(b365, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") +  ggtitle("Bet 365")+
geom_smooth()
b365$P_draw<-1/b365$B365D
b365$sum_prob<-b365$P_home + b365$P_draw + b365$P_away
b365$NP_home<-b365$P_home/b365$sum_prob
b365$P_away<-1/b365$B365A
b365$p_range<-cut(b365$ph_pa,breaks = seq(-1,1,by=0.05))
b<-b365 %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
b$ort<-seq(-0.825,0.925,by=0.05)
b$draw_real_prob<-b$draw_num/b$obs
ggplot() +
geom_point(data=b365, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=b365, aes(x=ph_pa, y=P_draw))+
geom_point(data=b,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=b,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
bw<-data[,c(1:8,23:24,28:30)]
bw$is_draw<-ifelse(bw$FTR=="D",1,0)
bw$P_home<-1/bw$BWH
bw$P_away<-1/bw$BWA
bw$P_draw<-1/bw$BWD
bw$sum_prob<-bw$P_home+bw$P_draw+bw$P_away
bw$NP_home<-bw$P_home/bw$sum_prob
bw$NP_draw<-bw$P_draw/bw$sum_prob
bw$NP_away<-bw$P_away/bw$sum_prob
bw$ph_pa<-bw$P_home-bw$P_away
bw$nph_npa<-bw$NP_home-bw$NP_away
ggplot(bw, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Bet and Win")
bw$p_range<-cut(bw$ph_pa,breaks = seq(-1,1,by=0.05))
bw_df<-bw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
bw_df$ort<-seq(-0.825,0.925,by=0.05)
bw_df$draw_real_prob<-bw_df$draw_num/bw_df$obs
ggplot() +
geom_point(data=bw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=bw, aes(x=ph_pa, y=P_draw))+
geom_point(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=bw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
iw<-data[,c(1:8,23:24,31:33)]
iw$is_draw<-ifelse(iw$FTR=="D",1,0)
iw$P_home<-1/iw$IWH
iw$P_draw<-1/iw$IWD
iw$P_away<-1/iw$IWA
iw$sum_prob<-iw$P_home+iw$P_draw+iw$P_away
iw$NP_home<-iw$P_home/iw$sum_prob
iw$NP_away<-iw$P_away/iw$sum_prob
iw$ph_pa<-iw$P_home-iw$P_away
iw$NP_draw<-iw$P_draw/iw$sum_prob
iw$nph_npa<-iw$NP_home-iw$NP_away
ggplot(iw, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Some Bookmaker")
iw$p_range<-cut(iw$ph_pa,breaks = seq(-1,1,by=0.05))
iw_df<-iw %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
iw_df$ort<-seq(-0.825,0.925,by=0.05)
iw_df$draw_real_prob<-iw_df$draw_num/iw_df$obs
ggplot() +
geom_point(data=iw, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=iw, aes(x=ph_pa, y=P_draw))+
geom_point(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=iw_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ps<-data[,c(1:8,23:24,31:33)]
ps<-data[,c(1:8,23:24,33:35)]
ps$is_draw<-ifelse(ps$FTR=="D",1,0)
ps$P_home<-1/ps$IWH
ps$P_draw<-1/ps$IWD
ps$P_away<-1/ps$IWA
ps$sum_prob<-ps$P_home+ps$P_draw+ps$P_away
ps$NP_home<-ps$P_home/ps$sum_prob
ps$NP_draw<-ps$P_draw/ps$sum_prob
ps$NP_away<-ps$P_away/ps$sum_prob
ps$ph_pa<-ps$P_home-ps$P_away
ps$nph_npa<-ps$NP_home-ps$NP_away
ggplot(ps, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Pinnacle")
ps$p_range<-cut(ps$ph_pa,breaks = seq(-1,1,by=0.05))
ggplot(ps, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Pinnacle")
ps$ph_pa<-ps$P_home-ps$P_away
View(ps)
ps<-data[,c(1:8,23:24,33:35)]
ps$is_draw<-ifelse(ps$FTR=="D",1,0)
ps$P_home<-1/ps$IWH
ps<-data[,c(1:8,23:24,33:35)]
ps$is_draw<-ifelse(ps$FTR=="D",1,0)
ps$P_home<-1/ps$IWH
ps<-data[,c(1:8,23:24,34:36)]
ps$is_draw<-ifelse(ps$FTR=="D",1,0)
ps$P_home<-1/ps$IWH
ps<-data[,c(1:8,23:24,34:36)]
ps$is_draw<-ifelse(ps$FTR=="D",1,0)
ps$P_home<-1/ps$PSH
ps$P_draw<-1/ps$PSD
ps$P_away<-1/ps$PSA
ps$sum_prob<-ps$P_home+ps$P_draw+ps$P_away
ps$NP_home<-ps$P_home/ps$sum_prob
ps$NP_draw<-ps$P_draw/ps$sum_prob
ps$NP_away<-ps$P_away/ps$sum_prob
ps$ph_pa<-ps$P_home-ps$P_away
ps$nph_npa<-ps$NP_home-ps$NP_away
ps$p_range<-cut(ps$ph_pa,breaks = seq(-1,1,by=0.05))
ggplot(ps, aes(ph_pa, P_draw)) +
geom_point()+ xlab("P(Home Win) – P(Away Win)") +
ylab("P (Tie)") + ggtitle("Pinnacle")
ps$p_range<-cut(ps$ph_pa,breaks = seq(-1,1,by=0.05))
ps_df<-ps %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
ps_df$ort<-seq(-0.825,0.925,by=0.05)
ps_df$draw_real_prob<-ps_df$draw_num/ps_df$obs
ggplot() +
geom_point(data=ps, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=ps, aes(x=ph_pa, y=P_draw))+
geom_point(data=ps_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=ps_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
#PINNACLE-remove red cards
t3_ps<-filter(ps, HR==0 & AR ==0)
t3_ps_df<-t3_ps %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
t3_ps_df$ort<-seq(-0.825,0.925,by=0.05)
t3_ps_df$draw_real_prob<-t3_ps_df$draw_num/t3_ps_df$obs
#PINNACLE-remove red cards
t3_ps<-filter(ps, HR==0 & AR ==0)
t3_ps_df<-t3_ps %>%
group_by(p_range) %>%
summarise(draw_num=sum(is_draw), obs=n())
t3_ps_df$ort<-seq(-0.825,0.925,by=0.05)
t3_ps_df$draw_real_prob<-t3_ps_df$draw_num/t3_ps_df$obs
ggplot() +
geom_point(data=t3_ps, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=t3_ps, aes(x=ph_pa, y=P_draw))+
geom_point(data=t3_ps_df,aes(x=ort,y=draw_real_prob,colour="red")) +geom_smooth(data=t3_ps_df,aes(x=ort,y=draw_real_prob,colour="red"),se=FALSE)
ggplot() +
geom_point(data=t3_ps, aes(x=ph_pa, y=P_draw))+ geom_smooth(data=t3_ps, aes(x=ph_pa, y=P_draw))+
geom_point(data=t3_ps_df,aes(x=ort,y=draw_real_prob,colour="red"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
x<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_X_TRAIN.txt")
y<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_Y_TRAIN.txt")
z<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_Z_TRAIN.txt")
colnames(x)[1]<-"class"
colnames(y)[1]<-"class"
colnames(z)[1]<-"class"
ins_1<- as.data.frame(cbind(x=t(filter(x,class==1))[,1],y=t(filter(y,class==1))[,1],z=t(filter(z,class==1))[,1]))[-1,]
ins_1<- data.frame(ins_1,vel_x=cumsum(ins_1$x),vel_y=cumsum(ins_1$y),vel_z=cumsum(ins_1$z))
ins_1<- data.frame(ins_1,pos_x=cumsum(ins_1$vel_x),pos_y=cumsum(ins_1$vel_y),pos_z=cumsum(ins_1$vel_z))
rownames(ins_1) <- 1:nrow(ins_1)
ins_1$row<-as.numeric(rownames(ins_1))/nrow(ins_1)
scatterplot3d(ins_1[,7:9],color=gray(ins_1$row))
ins_2<- as.data.frame(cbind(x=t(filter(x,class==2))[,2],y=t(filter(y,class==2))[,2],z=t(filter(z,class==2))[,2]))[-1,]
ins_2<- data.frame(ins_2,vel_x=cumsum(ins_2$x),vel_y=cumsum(ins_2$y),vel_z=cumsum(ins_2$z))
ins_2<- data.frame(ins_2,pos_x=cumsum(ins_2$vel_x),pos_y=cumsum(ins_2$vel_y),pos_z=cumsum(ins_2$vel_z))
scatterplot3d(ins_2[,7:9],color="red")
library(scatterplot3d)
library(readr)
library(dplyr)
library(scatterplot3d)
x<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_X_TRAIN.txt")
x<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_X_TRAIN.txt")
y<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_Y_TRAIN.txt")
z<-read.table("C:/Users/asus/Desktop/homework 2/UWave/uWaveGestureLibrary_Z_TRAIN.txt")
colnames(x)[1]<-"class"
colnames(y)[1]<-"class"
colnames(z)[1]<-"class"
ins_1<- as.data.frame(cbind(x=t(filter(x,class==1))[,1],y=t(filter(y,class==1))[,1],z=t(filter(z,class==1))[,1]))[-1,]
ins_1<- data.frame(ins_1,vel_x=cumsum(ins_1$x),vel_y=cumsum(ins_1$y),vel_z=cumsum(ins_1$z))
ins_1<- data.frame(ins_1,pos_x=cumsum(ins_1$vel_x),pos_y=cumsum(ins_1$vel_y),pos_z=cumsum(ins_1$vel_z))
rownames(ins_1) <- 1:nrow(ins_1)
ins_1$row<-as.numeric(rownames(ins_1))/nrow(ins_1)
scatterplot3d(ins_1[,7:9],color=gray(ins_1$row))
ins_2<- as.data.frame(cbind(x=t(filter(x,class==2))[,2],y=t(filter(y,class==2))[,2],z=t(filter(z,class==2))[,2]))[-1,]
ins_2<- data.frame(ins_2,vel_x=cumsum(ins_2$x),vel_y=cumsum(ins_2$y),vel_z=cumsum(ins_2$z))
ins_2<- data.frame(ins_2,pos_x=cumsum(ins_2$vel_x),pos_y=cumsum(ins_2$vel_y),pos_z=cumsum(ins_2$vel_z))
scatterplot3d(ins_2[,7:9],color="red")
ins_3<- as.data.frame(cbind(x=t(filter(x,class==3))[,2],y=t(filter(y,class==3))[,2],z=t(filter(z,class==3))[,2]))[-1,]
ins_3<- data.frame(ins_3,vel_x=cumsum(ins_3$x),vel_y=cumsum(ins_3$y),vel_z=cumsum(ins_3$z))
ins_3<- data.frame(ins_3,pos_x=cumsum(ins_3$vel_x),pos_y=cumsum(ins_3$vel_y),pos_z=cumsum(ins_3$vel_z))
scatterplot3d(ins_3[,7:9],color="red")
ins_4<- as.data.frame(cbind(x=t(filter(x,class==4))[,1],y=t(filter(y,class==4))[,1],z=t(filter(z,class==4))[,1]))[-1,]
ins_4<- data.frame(ins_4,vel_x=cumsum(ins_4$x),vel_y=cumsum(ins_4$y),vel_z=cumsum(ins_4$z))
ins_4<- data.frame(ins_4,pos_x=cumsum(ins_4$vel_x),pos_y=cumsum(ins_4$vel_y),pos_z=cumsum(ins_4$vel_z))
scatterplot3d(ins_4[,7:9],color="red")
ins_5<- as.data.frame(cbind(x=t(filter(x,class==5))[,1],y=t(filter(y,class==5))[,1],z=t(filter(z,class==5))[,1]))[-1,]
ins_5<- data.frame(ins_5,vel_x=cumsum(ins_5$x),vel_y=cumsum(ins_5$y),vel_z=cumsum(ins_5$z))
ins_5<- data.frame(ins_5,pos_x=cumsum(ins_5$vel_x),pos_y=cumsum(ins_5$vel_y),pos_z=cumsum(ins_5$vel_z))
scatterplot3d(ins_5[,7:9],color="red")
ins_6<- as.data.frame(cbind(x=t(filter(x,class==6))[,3],y=t(filter(y,class==6))[,3],z=t(filter(z,class==6))[,3]))[-1,]
ins_6<- data.frame(ins_6,vel_x=cumsum(ins_6$x),vel_y=cumsum(ins_6$y),vel_z=cumsum(ins_6$z))
ins_6<- data.frame(ins_6,pos_x=cumsum(ins_6$vel_x),pos_y=cumsum(ins_6$vel_y),pos_z=cumsum(ins_6$vel_z))
scatterplot3d(ins_6[,7:9],color="red")
ins_7<- as.data.frame(cbind(x=t(filter(x,class==7))[,3],y=t(filter(y,class==4))[,3],z=t(filter(z,class==7))[,3]))[-1,]
ins_7<- data.frame(ins_7,vel_x=cumsum(ins_7$x),vel_y=cumsum(ins_7$y),vel_z=cumsum(ins_7$z))
ins_7<- data.frame(ins_7,pos_x=cumsum(ins_7$vel_x),pos_y=cumsum(ins_7$vel_y),pos_z=cumsum(ins_7$vel_z))
scatterplot3d(ins_7[,7:9],color="red")
colnames(x)[2:316]<-c(1:315)
colnames(y)[2:316]<-c(1:315)
colnames(z)[2:316]<-c(1:315)
x<-cbind(observation=c(1:nrow(x)),x)
x_long<-gather(x,key="time index", value= "x",c(3:317))
y<-cbind(observation=c(1:nrow(y)),y)
y_long<-gather(y,key="time index", value= "y",c(3:317))
z<-cbind(observation=c(1:nrow(z)),z)
z_long<-gather(z,key="time index", value= "z",c(3:317))
df<-cbind(x_long,y=y_long$y,z=z_long$z)
summary(df) #To check if scaling is needed.
df_pca<-princomp(df[,-c(1:3)])
summary(df_pca, loadings=T)
new_df<-cbind(df[,c(1:3)],mapping_c1=df_pca$scores[,1]) #Mapping of component 1.
View(new_df)
head(new_df)
class_1_pca<-filter(new_df,class==1)
#Observation 11 and 17 are selected.
class_1_ts<-as.data.frame(cbind(time_index=c(1:315),obs_11=filter(class_1_pca,observation==11)$mapping_c1,obs_17=filter(class_1_pca,observation==17)$mapping_c1))
ggplot(class_1_ts)+
geom_line(aes(x=time_index,y=obs_11),color="red")+
geom_line(aes(x=time_index,y=obs_17),color="blue")
class_2_pca<-filter(new_df,class==2)
#Observation 15 and 20 are selected.
class_2_ts<-as.data.frame(cbind(time_index=c(1:315),obs_15=filter(class_2_pca,observation==15)$mapping_c1,obs_20=filter(class_2_pca,observation==20)$mapping_c1))
ggplot(class_2_ts)+
geom_line(aes(x=time_index,y=obs_15),color="red")+
geom_line(aes(x=time_index,y=obs_20),color="blue")
class_3_pca<-filter(new_df,class==3)
#Observation 4 and 13 are selected.
class_3_ts<-as.data.frame(cbind(time_index=c(1:315),obs_4=filter(class_3_pca,observation==4)$mapping_c1,obs_13=filter(class_3_pca,observation==13)$mapping_c1))
ggplot(class_3_ts)+
geom_line(aes(x=time_index,y=obs_4),color="red")+
geom_line(aes(x=time_index,y=obs_13),color="blue")
class_4_pca<-filter(new_df,class==4)
#Observation 5 and 8 are selected.
class_4_ts<-as.data.frame(cbind(time_index=c(1:315),obs_5=filter(class_4_pca,observation==5)$mapping_c1,obs_8=filter(class_4_pca,observation==8)$mapping_c1))
ggplot(class_4_ts)+
geom_line(aes(x=time_index,y=obs_5),color="red")+
geom_line(aes(x=time_index,y=obs_8),color="blue")
class_5_pca<-filter(new_df,class==5)
#Observation 2 and 3 are selected.
class_5_ts<-as.data.frame(cbind(time_index=c(1:315),obs_2=filter(class_5_pca,observation==2)$mapping_c1,obs_3=filter(class_5_pca,observation==3)$mapping_c1))
ggplot(class_5_ts)+
geom_line(aes(x=time_index,y=obs_2),color="red")+
geom_line(aes(x=time_index,y=obs_3),color="blue")
class_6_pca<-filter(new_df,class==6)
#Observation 1 and 10 are selected.
class_6_ts<-as.data.frame(cbind(time_index=c(1:315),obs_1=filter(class_6_pca,observation==1)$mapping_c1,obs_10=filter(class_6_pca,observation==10)$mapping_c1))
ggplot(class_6_ts)+
geom_line(aes(x=time_index,y=obs_1),color="red")+
geom_line(aes(x=time_index,y=obs_10),color="blue")
class_7_pca<-filter(new_df,class==7)
#Observation 7 and 12 are selected.
class_7_ts<-as.data.frame(cbind(time_index=c(1:315),obs_7=filter(class_7_pca,observation==7)$mapping_c1,obs_12=filter(class_7_pca,observation==12)$mapping_c1))
ggplot(class_7_ts)+
geom_line(aes(x=time_index,y=obs_7),color="red")+
geom_line(aes(x=time_index,y=obs_12),color="blue")
class_8_pca<-filter(new_df,class==8)
#Observation 6 and 21 are selected.
class_8_ts<-as.data.frame(cbind(time_index=c(1:315),obs_6=filter(class_8_pca,observation==6)$mapping_c1,obs_21=filter(class_8_pca,observation==21)$mapping_c1))
ggplot(class_8_ts)+
geom_line(aes(x=time_index,y=obs_6),color="red")+
geom_line(aes(x=time_index,y=obs_21),color="blue")
class_based_pca<-df %>% split(.$class) %>% map(~princomp(.[,-c(1:3)]))
map(class_based_pca,summary)
summary(df_pca, loadings=T)
